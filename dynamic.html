<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dynamic Zone - DAP Test Site</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="responsive.css">
  <link rel="stylesheet" href="components.css">
  <style>
    /* Specific styles for the chaos zone */
    .chaos-box { border: 2px dashed #f59e0b; padding: 15px; background: #fffbeb; margin-bottom: 20px; }
    .generated-class-1x2y3 { background: #e0e7ff; padding: 10px; border-radius: 4px; margin-bottom: 5px; }
  </style>
</head>
<body>
  <div class="page-wrapper">
    <nav class="sidebar">
      <div class="nav-logo">üß™ DAP Test Site</div>
      <ul class="nav-menu">
        <li class="nav-item"><a href="index.html" class="nav-link">Dashboard</a></li>
        <li class="nav-item"><a href="forms.html" class="nav-link">Forms</a></li>
        <li class="nav-item"><a href="tables.html" class="nav-link">Tables</a></li>
        <li class="nav-item"><a href="user-management.html" class="nav-link">Users</a></li>
        <li class="nav-item"><a href="settings.html" class="nav-link">Settings</a></li>
        <li class="nav-item"><a href="navigation.html" class="nav-link">Navigation</a></li>
        <li class="nav-item"><a href="workflow.html" class="nav-link">Workflows</a></li>
        <li class="nav-item"><a href="advanced.html" class="nav-link">Advanced</a></li>
        <li class="nav-item"><a href="responsive.html" class="nav-link">Responsive</a></li>
        <li class="nav-item"><a href="dynamic.html" class="nav-link active">Dynamic (Chaos)</a></li>
      </ul>
    </nav>

    <div class="main-content">
      <header>
        <h1 style="margin: 0;">Dynamic & Unstable Elements</h1>
        <div class="badge badge-warning">Caution: IDs change on reload</div>
      </header>

      <main>
        <div class="breadcrumb">
          <span class="breadcrumb-item">Home</span>
          <span class="breadcrumb-item active">Dynamic</span>
        </div>

        <div class="alert alert-warning">
          <span>‚ö†Ô∏è</span>
          <span>This page mimics complex environments like Salesforce, React, and Shadow DOM. Selectors relying on IDs will fail here.</span>
        </div>

        <div class="card">
          <div class="card-header"><h3>1. The "Dynamic ID" Trap</h3></div>
          <div class="card-body">
            <p>These buttons get a new random ID every time you refresh (e.g., <code>#gen-928</code>).</p>
            <div class="btn-group" id="dynamic-btn-container">
              <button class="btn btn-outline dynamic-id-target">Action A</button>
              <button class="btn btn-outline dynamic-id-target">Action B</button>
              <button class="btn btn-outline dynamic-id-target">Action C</button>
            </div>
            <p style="font-size:12px; color:#666; margin-top:10px;"><em>Test Goal: Use "Text Match" or "CSS Class" selectors instead of ID.</em></p>
          </div>
        </div>

        <div class="card">
          <div class="card-header"><h3>2. Shifting DOM Position</h3></div>
          <div class="card-body">
            <p>The "Submit" button changes its position in the list randomly.</p>
            <div id="shuffle-container" style="display: flex; gap: 10px; flex-direction: column;">
                <div class="generated-class-1x2y3">Standard Field 1</div>
                <div class="generated-class-1x2y3">Standard Field 2</div>
                <button class="btn btn-primary" id="floating-submit-btn">Submit (Find me!)</button>
                <div class="generated-class-1x2y3">Standard Field 3</div>
            </div>
            <p style="font-size:12px; color:#666; margin-top:10px;"><em>Test Goal: Use "Relative" selectors (e.g., "Find button containing text 'Submit'").</em></p>
          </div>
        </div>

        <div class="card">
          <div class="card-header"><h3>3. Shadow DOM Isolation</h3></div>
          <div class="card-body">
            <p>This button is hidden inside a Shadow Root. <code>document.getElementById</code> won't find it easily.</p>
            <div id="shadow-host-root" style="border:1px solid #ccc; padding:20px; border-radius:8px;"></div>
          </div>
        </div>

        <div class="card">
          <div class="card-header"><h3>4. Iframe Context</h3></div>
          <div class="card-body">
            <p>This area loads a separate HTML document.</p>
            <iframe id="test-iframe" style="width:100%; height:150px; border:2px solid #e2e8f0; border-radius:8px;"></iframe>
          </div>
        </div>

      </main>
    </div>
  </div>

  <script src="main.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
        // 1. Randomize IDs
        document.querySelectorAll('.dynamic-id-target').forEach(btn => {
            btn.id = 'gen-' + Math.floor(Math.random() * 100000);
        });

        // 2. Shuffle Elements
        const container = document.getElementById('shuffle-container');
        for (let i = container.children.length; i >= 0; i--) {
            container.appendChild(container.children[Math.random() * i | 0]);
        }

        // 3. Shadow DOM Injection
        const host = document.getElementById('shadow-host-root');
        const shadow = host.attachShadow({mode: 'open'});
        const shadowBtn = document.createElement('button');
        shadowBtn.innerText = "I am inside Shadow DOM";
        shadowBtn.style.padding = "10px 20px";
        shadowBtn.style.background = "#7c3aed";
        shadowBtn.style.color = "white";
        shadowBtn.style.border = "none";
        shadowBtn.style.borderRadius = "4px";
        shadowBtn.style.cursor = "pointer";
        shadowBtn.onclick = () => alert("Shadow Clicked!");
        shadow.appendChild(shadowBtn);

        // 4. Iframe Content
        const iframe = document.getElementById('test-iframe');
        iframe.srcdoc = `
            <style>body { font-family: sans-serif; padding: 20px; text-align: center; }</style>
            <h3>Iframe Content</h3>
            <button style="padding:10px; cursor:pointer;" onclick="alert('Iframe Click')">Click Inside Iframe</button>
        `;
    });
  </script>
</body>
</html>
